---
comments: true
date: 2008-02-11 13:54:36
layout: post
slug: vmsplice-exploit-para-acceder-a-la-cuenta-root-en-linux
title: vmsplice, exploit para acceder a la cuenta root en linux
wordpress_id: 51
categories:
- Seguridad
---

Via [Kriptópolis](http://www.kriptopolis.org/bug-kernel-linux):

> Como muchos ya sabréis, se ha descubierto una grave [vulnerabilidad](http://www.securityfocus.com/bid/27704en) el kernel linux (2.6.x - 2.6.24.1) que permite a un usuario con acceso local obtener privilegios de root ejecutando un simple exploit.
> 
> En kriptópolis hay más detalles, y un enlace a donde se puede descargar el fuente del exploit.

Con esto se puede construir un virus bastante destructivo que ataque a los equipos que tengan este bug, algo que[discutimos anteriormente](http://www.lnds.net/2008/01/la_seguridad_de_linux.html#comments).

Aunque el bug fue [rápidamente corregido](http://lkml.org/lkml/2008/2/11/25) (algo común en el mundo FOSS), el problema, nuevamente, es que los usuarios no mantienen sus sistemas parchados, además que hay usuarios no expertos que no van a saber como parchar su kernel.

Así que si están usando linux, verifiquen si son vulnerables a este exploit y apliquen los parches, y corran la voz.

La correción del bug es interesante por lo sencilla que resulta, y agregar 3 lineas del archivo linux-2.6/fs/splice.c:

> `@ -1237,6 +1237,9 @` static int get_iovec_page_array(const st  
if (unlikely(!base))  
break;  
  
bq. +	 if (unlikely(!access_ok(VERIFY_READ, base, len)))  
+	 break;  
+  
/*  
* Get this base offset and number of pages, then map  
* in the user pages.



